sitecues.def('cursor/custom', function (customCursor, callback) {
  'use strict';

  var PREFIX = '<svg xmlns="http://www.w3.org/2000/svg" width="SIDE" height="SIDE" viewBox="0,0,SIDE,SIDE"><defs><filter id="d" width="200%" height="200%"><feOffset result="offOut" in="SourceAlpha" dx=".25" dy=".5" /><feGaussianBlur result="blurOut" in="offOut" stdDeviation=".5" /><feBlend in="SourceGraphic" in2="blurOut" mode="normal" /></filter></defs><g transform="scale(SIZE)" filter="url(#d)">',
    POSTFIX = '</g><defs/></svg>',
    CURSOR_SVG = {
      // Optimized to 2 decimal places via the SVG optimizer at https://petercollingridge.appspot.com/svg-editor
      win: {
        default:
          '<path fill="#000" d="M0 0L0 17.75 4.19 13.88 8.25 21.06 11.53 18.72 7.75 12.06 12.59 12 0 0z"/>' +
          '<path fill="#FFF" d="M0.93 2.28L1 15.06 4.28 12 8.56 19.47 10.16 18.41 5.88 11.06 10.06 11 0.93 2.28z"/>',
        pointer:
          '<path fill="#000" d="M16.63 14.33C16.64 15.76 16.53 15.94 16.4 16.32 16.23 16.83 15.68 17.86 15.15 18.7L14.73 19.34 14.73 20.48 14.72 21.97 9.79 21.97C5.91 21.97 4.91 22.04 4.91 21.97 4.91 21.13 4.11 18.88 3.76 17.97 3.07 16.22 2.47 15.22 0.8 12.89 -0.24 11.45-0.17 11.27-0.23 10.58 -0.33 9.6 0.12 8.94 1.36 8.95 2.07 8.95 2.45 9.32 3.36 9.83L3.81 10.19 3.85 5.68C3.88 1.29 3.89 1.17 4.01 0.95 4.2 0.66 4.81 0.36 5.22 0.24 5.41 0.19 5.78 0.16 6.09 0.17 7.03 0.2 7.64 0.61 7.79 1.28 7.83 1.45 7.87 2.44 7.87 3.55L7.87 5.52 8.16 5.49C8.92 5.4 9.86 5.77 10.24 6.3 10.42 6.55 10.48 6.6 10.63 6.57 11.71 6.37 12.54 6.58 13.17 7.2 13.32 7.36 13.45 7.51 13.45 7.54 13.45 7.57 13.67 7.58 13.94 7.55 14.45 7.51 15.08 7.6 15.41 7.77 15.74 7.93 16.08 8.27 16.26 8.62 16.44 8.96 16.53 8.97 16.58 10.85 16.6 11.89 16.62 13.46 16.63 14.33z"/>' +
          '<path fill="#FFF" d="M15.48 16.43C15.64 15.91 15.65 14.97 15.56 11.5 15.51 9.91 15.48 9.53 15.38 9.29 15.16 8.75 14.62 8.48 13.97 8.58L13.64 8.64 13.61 10.14C13.6 11.45 13.59 11.65 13.49 11.72 13.35 11.82 13.04 11.83 12.85 11.74 12.73 11.67 12.73 11.58 12.73 10.15L12.73 8.64 12.53 8.33C12.24 7.87 11.81 7.65 11.24 7.65 11 7.66 10.76 7.68 10.72 7.71 10.66 7.74 10.64 8.19 10.64 9.2 10.64 10.23 10.62 10.67 10.56 10.73 10.51 10.77 10.35 10.8 10.2 10.8 9.71 10.8 9.7 10.77 9.7 9.08 9.7 7.4 9.66 7.24 9.15 6.9 8.9 6.74 8.81 6.72 8.33 6.72L7.78 6.72 7.76 8.68C7.75 10.43 7.74 10.65 7.64 10.72 7.5 10.82 7.18 10.83 7 10.74 6.88 10.67 6.88 10.55 6.88 6.25L6.88 1.83 6.71 1.67C6.63 1.58 6.44 1.48 6.3 1.44 5.79 1.3 5.37 1.37 5.08 1.65L4.92 1.79 4.92 7.19C4.92 13.22 4.96 12.77 4.44 12.75 4.05 12.73 3.99 12.65 3.97 12.11L3.95 11.39 3.48 11.03C2.98 10.67 2.64 10.2 2.21 10.06 1.94 9.97 1.43 9.85 1.16 10.09 0.69 10.5 0.86 11.02 0.99 11.26 1.33 11.92 1.41 12 1.91 12.69 3.88 15.41 3.84 15.5 5.64 20.49L5.68 21.11 9.74 21.11 13.8 21.11 13.8 20.25 13.8 19.39 14.31 18.65C14.9 17.79 15.28 17.07 15.48 16.43z"/>'
      },
      mac: {
        default:
          '<path fill="#FFF" d="M1.02 0.42L1.03 16.78 4.31 13.28 6.45 18.48 10.34 17.03 8.06 11.88 12.5 11.87 1.02 0.42z"/>' +
          '<path fill="#000" d="M1.94 2.88L2.03 14.19 4.53 11.63 6.97 17.31 9.03 16.56 6.69 10.94 10 10.94"/>',
        pointer:
          '<path fill="#000" d="M5.1 1.33C4.84 1.4 4.49 1.63 4.36 1.83 3.91 2.48 3.87 3.75 4.23 5.72 4.36 6.44 4.69 7.98 4.76 8.21 4.79 8.28 4.69 8.22 4.5 8.05 3.85 7.47 3.36 7.22 2.81 7.22 2.18 7.22 1.64 7.59 1.34 8.23 1.2 8.53 1.18 8.61 1.19 9.02 1.19 9.77 1.41 10.18 2.63 11.74 3.2 12.46 3.4 12.76 3.93 13.7 4.06 13.93 4.38 14.3 5.2 15.1L6.29 16.19 6.31 16.82 6.32 17.44 8.16 17.46 10 17.47 10.58 16.89 11.16 16.31 11.74 16.89 12.32 17.47 13.23 17.46 14.14 17.44 14.16 16.43 14.19 15.43 14.37 15.1C14.47 14.92 14.76 14.5 15 14.16 15.25 13.83 15.6 13.34 15.78 13.08 16.5 12.05 16.49 12.08 16.47 9.39 16.45 7.28 16.45 7.26 16.34 7.04 16.17 6.72 15.92 6.47 15.61 6.3 15.38 6.17 15.3 6.15 14.94 6.15 14.58 6.15 14.49 6.17 14.21 6.32 14.04 6.41 13.89 6.47 13.89 6.47 13.88 6.46 13.82 6.32 13.74 6.16 13.57 5.82 13.29 5.55 12.91 5.37 12.66 5.26 12.56 5.24 12.15 5.24 11.61 5.24 11.35 5.33 11.03 5.62 10.85 5.77 10.84 5.77 10.81 5.68 10.75 5.49 10.24 5.08 9.94 4.96 9.52 4.8 9.03 4.81 8.65 4.98 8.49 5.05 8.28 5.17 8.19 5.25 8.07 5.33 8.01 5.36 8.01 5.31 8.01 5.18 7.86 4.23 7.78 3.88 7.5 2.62 6.98 1.76 6.31 1.45 6 1.31 5.42 1.25 5.1 1.33z"/>' +
          '<path fill="#FFF" d="M0 0 6.03 2.22C6.33 2.39 6.61 2.84 6.8 3.42 6.99 4.02 7.03 4.26 7.18 5.6 7.25 6.21 7.34 6.91 7.38 7.13 7.59 8.23 7.85 8.6 8.15 8.28 8.25 8.17 8.27 8.07 8.31 7.27 8.34 6.79 8.38 6.34 8.41 6.27 8.51 6.02 8.86 5.83 9.25 5.83 9.51 5.82 9.92 6.01 10.09 6.22 10.22 6.38 10.23 6.41 10.23 6.92 10.23 7.6 10.31 8.13 10.42 8.25 10.48 8.32 10.56 8.34 10.7 8.33 11.02 8.31 11.07 8.2 11.15 7.28L11.21 6.51 11.42 6.35C11.72 6.12 12.11 6.04 12.53 6.11 13.09 6.21 13.16 6.34 13.25 7.38 13.34 8.29 13.4 8.44 13.71 8.44 13.91 8.44 14.05 8.25 14.19 7.81 14.38 7.17 14.69 6.95 15.18 7.09 15.42 7.15 15.55 7.32 15.62 7.64 15.69 7.96 15.69 10.18 15.62 11.04 15.58 11.65 15.56 11.72 15.37 12.1 15.18 12.48 14.59 13.31 13.9 14.16 13.75 14.36 13.6 14.56 13.57 14.62 13.52 14.71 13.41 16.04 13.41 16.49L13.41 16.66 12.96 16.66 12.51 16.66 11.89 15.98C11.55 15.61 11.26 15.3 11.24 15.3 11.22 15.3 10.91 15.61 10.53 15.98L9.85 16.66 8.51 16.66 7.15 16.66 7.15 16.21 7.15 15.76 6.74 15.4C6.51 15.19 6.12 14.85 5.88 14.65 5.29 14.16 4.98 13.79 4.5 13.03 4.28 12.68 3.71 11.83 3.22 11.14 2.02 9.42 1.96 9.32 1.96 9.11 1.96 8.65 2.47 8.09 2.88 8.09 3.44 8.09 4.52 8.94 5.11 9.84 5.49 10.41 5.63 10.49 5.94 10.33 6.06 10.27 6.1 10.21 6.13 10.02 6.17 9.7 6.04 8.93 5.76 7.93 5.09 5.52 4.83 4.26 4.83 3.47 4.83 2.47 5.03 2.09 5.55 2.09 5.74 2.09 5.87 2.13 6.03 2.22z"/>' +
          '<path fill="#000" d="M8.74 10.25L8.74 10.25C8.94 10.25 9.1 10.41 9.1 10.6L9.1 13.99C9.1 14.19 8.94 14.34 8.74 14.34L8.74 14.34C8.54 14.34 8.38 14.19 8.38 13.99L8.38 10.6C8.38 10.41 8.54 10.25 8.74 10.25z"/>' +
          '<path fill="#000" d="M10.8 10.25L10.8 10.25C11 10.25 11.16 10.41 11.16 10.6L11.16 13.99C11.16 14.19 11 14.34 10.8 14.34L10.8 14.34C10.6 14.34 10.44 14.19 10.44 13.99L10.44 10.6C10.44 10.41 10.6 10.25 10.8 10.25z"/> <path fill="#000" d="M12.69 10.25L12.69 10.25C12.89 10.25 13.06 10.41 13.06 10.6L13.06 13.99C13.06 14.19 12.89 14.34 12.69 14.34L12.69 14.34C12.5 14.34 12.33 14.19 12.33 13.99L12.33 10.6C12.33 10.41 12.5 10.25 12.69 10.25z"/>'
        }
      };

  sitecues.use('platform', function (platform) {

    /**
     * Get a URL for the cursor given the current platform
     * @param type 'default' or 'pointer'  (for auto cursor, use 'default')
     * @param sizeRatio a number > 1 (e.g. 2 = 2x)
     * @param pixelRatio = 1 for normal, 2 for retina cursor
     */
    customCursor.getUrl = function(type, sizeRatio, pixelRatio) {

      if (platform.browser.is === 'IE') {
        return sitecues.resolveSitecuesUrl( '../images/cursors/win_' + type + '_' + Math.min(sizeRatio,3) + '.cur' );
      }

      var prefix = PREFIX
          .replace(/SIZE/g, '' + sizeRatio * pixelRatio)
          .replace(/SIDE/g, '' + 128 * pixelRatio),
        cursorSvg = prefix + CURSOR_SVG[platform.os.is][type] + POSTFIX;

      return 'data:image/svg+xml,' + escape( cursorSvg );
    };

    // Done.
    callback();

  });

});