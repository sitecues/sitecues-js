sitecues.def('cursor/custom', function (customCursor, callback) {
  'use strict';

  var PREFIX = '<svg xmlns="http://www.w3.org/2000/svg" width="SIDE" height="SIDE" viewBox="0,0,SIDE,SIDE"><defs><filter id="d" width="200%" height="200%"><feOffset result="offOut" in="SourceAlpha" dx=".25" dy=".5" /><feGaussianBlur result="blurOut" in="offOut" stdDeviation=".5" /><feBlend in="SourceGraphic" in2="blurOut" mode="normal" /></filter></defs><g transform="scale(SIZE)" filter="url(#d)">',
    POSTFIX = '</g><defs/></svg>',
    CURSOR_SVG = {
      // Optimized to 2 decimal places via the SVG optimizer at https://petercollingridge.appspot.com/svg-editor
      win: {
        default:
          '<path d="M0 0L0 17.8 4.2 13.9 8.3 21.1 11.5 18.7 7.8 12.1 12.6 12 0 0z"/>' +
          '<path fill="#FFF" d="M.9 2.3L1 15.1 4.3 12 8.6 19.5 10.2 18.4 5.9 11.1 10.1 11 .9 2.3z"/>',
        pointer:
          '<path d="m16.6,14.3c0,1.5 -.1,1.6 -.2,2c-.2,.5 -.7,1.6 -1.2,2.4l-.5,.6l0,1.2l0,1.5l-4.9,0c-3.9,0 -4.9,0 -4.9,0c0,-.9 -.8,-3.1 -1.1,-4c-.7,-1.8 -1.3,-2.8 -3,-5.1c-1,-1.4 -1,-1.6 -1,-2.3c-.1,-1 .3,-1.7 1.6,-1.6c.7,0 1.1,.3 2,.8l.4,.4l.1,-4.5c0,-4.4 0,-4.5 .1,-4.7c.2,-.3 .8,-.6 1.2,-.8c.2,0 .6,0 .9,0c.9,0 1.5,.4 1.7,1.1c0,.2 .1,1.1 .1,2.3l0,1.9l.3,0c.7,-.1 1.7,.3 2,.8c.2,.3 .3,.3 .4,.3c1.1,-.2 1.9,0 2.6,.6c.1,.2 .3,.3 .3,.3c0,.1 .2,.1 .4,.1c.6,-.1 1.2,0 1.5,.2c.3,.1 .7,.5 .9,.8c.1,.4 .2,.4 .3,2.3c0,1 0,2.6 0,3.4z"/>' +
          '<path fill="#FFF" d="m15.5,16.4c.1,-.5 .2,-1.4 .1,-4.9c-.1,-1.6 -.1,-2 -.2,-2.2c-.2,-.5 -.8,-.8 -1.4,-.7l-.4,0l0,1.5c0,1.4 0,1.6 -.1,1.6c-.1,.1 -.5,.1 -.6,0c-.2,0 -.2,-.1 -.2,-1.5l0,-1.6l-.2,-.3c-.3,-.4 -.7,-.6 -1.3,-.6c-.2,0 -.4,0 -.5,0c0,0 -.1,.5 -.1,1.5c0,1 0,1.5 0,1.5c-.1,.1 -.2,.1 -.4,.1c-.5,0 -.5,0 -.5,-1.7c0,-1.7 0,-1.9 -.5,-2.2c-.3,-.2 -.4,-.2 -.9,-.2l-.5,0l0,2c0,1.7 -.1,2 -.2,2c-.1,.1 -.4,.1 -.6,0c-.1,0 -.1,-.1 -.1,-4.4l0,-4.5l-.2,-.1c-.1,-.1 -.3,-.2 -.4,-.3c-.5,-.1 -.9,0 -1.2,.3l-.2,.1l0,5.4c0,6 .1,5.6 -.5,5.6c-.3,-.1 -.4,-.1 -.4,-.7l0,-.7l-.5,-.4c-.5,-.3 -.9,-.8 -1.3,-.9c-.3,-.1 -.8,-.2 -1,0c-.5,.4 -.3,.9 -.2,1.2c.3,.6 .4,.7 .9,1.4c2,2.7 1.9,2.8 3.7,7.8l.1,.6l4,0l4.1,0l0,-.8l0,-.9l.5,-.7c.6,-.9 1,-1.6 1.2,-2.3z"/>'
        },
      mac: {
        default:
          '<path fill="#FFF" d="M1 .4L1 16.8 4.3 13.3 6.5 18.5 10.3 17 8.1 11.9 12.5 11.9 1 .4z"/>' +
          '<path d="M1.9 2.9L2 14.2 4.5 11.6 7 17.3 9 16.6 6.7 10.9 10 10.9"/>',
        pointer:
          '<path d="m5.1,1.3c-.3,.1 -.6,.3 -.7,.5c-.5,.7 -.5,2 -.2,3.9c.2,.7 .5,2.3 .6,2.5c0,.1 -.1,0 -.3,-.1c-.6,-.6 -1.1,-.9 -1.7,-.9c-.6,0 -1.2,.4 -1.5,1c-.1,.3 -.1,.4 -.1,.8c0,.8 .2,1.2 1.4,2.7c.6,.8 .8,1.1 1.3,2c.2,.2 .5,.6 1.3,1.4l1.1,1.1l0,.6l0,.6l1.9,.1l1.8,0l.6,-.6l.6,-.6l.5,.6l.6,.6l.9,0l.9,-.1l.1,-1l0,-1l.2,-.3c.1,-.2 .4,-.6 .6,-.9c.3,-.4 .6,-.9 .8,-1.1c.7,-1 .7,-1 .7,-3.7c0,-2.1 0,-2.1 -.2,-2.4c-.1,-.3 -.4,-.5 -.7,-.7c-.2,-.1 -.3,-.1 -.7,-.1c-.3,0 -.4,0 -.7,.1c-.2,.1 -.3,.2 -.3,.2c0,0 -.1,-.2 -.2,-.3c-.1,-.4 -.4,-.6 -.8,-.8c-.2,-.1 -.3,-.2 -.7,-.2c-.6,0 -.8,.1 -1.2,.4c-.1,.2 -.2,.2 -.2,.1c0,-.2 -.6,-.6 -.9,-.7c-.4,-.2 -.9,-.2 -1.2,0c-.2,.1 -.4,.2 -.5,.3c-.1,0 -.2,.1 -.2,0c0,-.1 -.1,-1.1 -.2,-1.4c-.3,-1.3 -.8,-2.1 -1.5,-2.4c-.3,-.2 -.9,-.2 -1.2,-.2z"/>' +
          '<path fill="#FFF" d="m0,0l6,2.2c.3,.2 .6,.6 .8,1.2c.2,.6 .2,.9 .4,2.2c.1,.6 .1,1.3 .2,1.5c.2,1.1 .5,1.5 .8,1.2c.1,-.1 .1,-.2 .1,-1c0,-.5 .1,-1 .1,-1c.1,-.3 .5,-.5 .9,-.5c.2,0 .6,.2 .8,.4c.1,.2 .1,.2 .1,.7c0,.7 .1,1.2 .2,1.4c.1,0 .2,0 .3,0c.3,0 .4,-.1 .5,-1l0,-.8l.2,-.1c.3,-.3 .7,-.4 1.1,-.3c.6,.1 .7,.2 .8,1.3c0,.9 .1,1 .4,1c.2,0 .4,-.1 .5,-.6c.2,-.6 .5,-.8 1,-.7c.2,.1 .4,.2 .4,.5c.1,.4 .1,2.6 0,3.4c0,.7 0,.7 -.2,1.1c-.2,.4 -.8,1.2 -1.5,2.1c-.1,.2 -.3,.4 -.3,.4c-.1,.1 -.2,1.4 -.2,1.9l0,.2l-.4,0l-.5,0l-.6,-.7c-.3,-.4 -.6,-.7 -.7,-.7c0,0 -.3,.3 -.7,.7l-.6,.7l-1.4,0l-1.3,0l0,-.5l0,-.4l-.5,-.4c-.2,-.2 -.6,-.5 -.8,-.7c-.6,-.5 -.9,-.9 -1.4,-1.7c-.2,-.3 -.8,-1.2 -1.3,-1.9c-1.2,-1.7 -1.2,-1.8 -1.2,-2c0,-.4 .5,-1 .9,-1c.5,0 1.6,.8 2.2,1.7c.4,.6 .5,.7 .8,.5c.2,0 .2,-.1 .2,-.3c.1,-.3 -.1,-1.1 -.3,-2.1c-.7,-2.4 -1,-3.6 -1,-4.4c0,-1 .2,-1.4 .8,-1.4c.1,0 .3,0 .4,.1l-6,-2.2z"/>' +
          '<path d="m8.7,10.3l0,0c.2,0 .4,.1 .4,.3l0,3.4c0,.2 -.2,.3 -.4,.3l0,0c-.2,0 -.3,-.1 -.3,-.3l0,-3.4c0,-.2 .1,-.3 .3,-.3z"/>' +
          '<path d="m10.8,10.3l0,0c.2,0 .4,.1 .4,.3l0,3.4c0,.2 -.2,.3 -.4,.3l0,0c-.2,0 -.4,-.1 -.4,-.3l0,-3.4c0,-.2 .2,-.3 .4,-.3z"/>' +
          '<path d="m12.7,10.3l0,0c.2,0 .4,.1 .4,.3l0,3.4c0,.2 -.2,.3 -.4,.3l0,0c-.2,0 -.4,-.1 -.4,-.3l0,-3.4c0,-.2 .2,-.3 .4,-.3z"/>'
        }
      };

  sitecues.use('platform', function (platform) {

    /**
     * Get a URL for the cursor given the current platform
     * @param type 'default' or 'pointer'  (for auto cursor, use 'default')
     * @param sizeRatio a number > 1 (e.g. 2 = 2x)
     * @param pixelRatio = 1 for normal, 2 for retina cursor
     */
    customCursor.getUrl = function(type, sizeRatio, pixelRatio) {

      if (platform.browser.is === 'IE') {
        return sitecues.resolveSitecuesUrl( '../images/cursors/win_' + type + '_' + Math.min(sizeRatio,3) + '.cur' );
      }

      var prefix = PREFIX
          .replace(/SIZE/g, '' + sizeRatio * pixelRatio)
          .replace(/SIDE/g, '' + 128 * pixelRatio),
        cursorSvg = prefix + CURSOR_SVG[platform.os.is][type] + POSTFIX;

      return 'data:image/svg+xml,' + escape( cursorSvg );
    };

    // Done.
    callback();

  });

});