<!DOCTYPE html>
<html>
<head>
  <title>Sitecues Data</title>
</head>
<body>
<script type="text/javascript">
  (function() {
    // If event.data is falsey, we are retrieving the data
    // If event.data is defined, we are saving the data
    function handleRequest(event) {
      if (event.data) {
        // Saving data
        try {
          localStorage.setItem('sitecues', event.data);
        }
        catch (ex) {
          // 'localStorage' prop inaccessible in iframe -- security settings must be set to 'disallow third party site data'
          // Swallow the exception -- we don't want to pollute the console.log for every setting save attempt
        }
      }
      else {
        // Retrieving data
        var value = '';
        try {
          value = localStorage.getItem('sitecues');
        }
        catch (ex) {
          // 'localStorage' prop inaccessible in iframe -- security settings must be set to 'disallow third party site data'
          console.log('Third party site data disallowed in browser security settings: Sitecues will not sync its settings between different websites.');
        }
        event.source.postMessage(value, event.origin);
      }
    }

    window.addEventListener('message', handleRequest);
  })();
</script>
</body>
</html>