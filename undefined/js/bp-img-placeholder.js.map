{"version":3,"sources":["../../config-wrap-start-default.js","bp-img-placeholder/bp-img-placeholder.js","../../../../../../module-create.js"],"names":["sitecues","define","BP_CONST","helper","inlineStyle","convertExistingBadge","badgeImg","newBadge","document","createElement","badgeImgBoundingBox","getRect","badgeComputedStyles","window","getComputedStyle","stylesToTransfer","transferStylesFromExistingBadge","styles","len","length","newBadgeStyles","badgeImageStyles","i","getNumberFromString","set","position","push","display","newHeight","height","WIDTH_TO_HEIGHT_RATIO","newBadgeStyle","width","float","setAttribute","parentElement","insertBefore","moveBadgeIdToParent","removeChild","id","BADGE_ID","invalidateId","init"],"mappings":"AAAA;;;;;;;;;;;;;;;;;ACgBAA,SAAAC,OACA,2CACA,oBACA,iBACA,mCAEA,SACAC,UACAC,QACAC;;;EAKA,SAAAC,qBAAAC;IAEA,IACAC,WAAAC,SAAAC,cAAA,OACAC,sBAAAP,OAAAQ,QAAAL,WACAM,sBAAAC,OAAAC,iBAAAR,WACAS,qBACA,aACA,gBACA,cACA,eACA,cACA,iBACA,eACA;;;IAKA,SAAAC,gCAAAC;MACA,IACAC,MAAAD,OAAAE,QACAC,qBACAC;MACA,KAAA,IAAAC,IAAA,GAAAA,IAAAJ,KAAAI,KAAA;QACAF,eAAAH,OAAAK,MAAAnB,OAAAoB,oBAAAX,oBAAAK,OAAAK,OAAA;QACAD,iBAAAJ,OAAAK,MAAA;;MAEAlB,YAAAoB,IAAAjB,UAAAa;MACAhB,YAAAoB,IAAAlB,UAAAe;;;IAIA,IAAA,eAAAjB,YAAAE,UAAAmB,UAAA;MACAV,iBAAAW,KAAA;MACAX,iBAAAW,KAAA;;IAGAV,gCAAAD;;IAGAX,YAAAG,UAAAoB,UAAA;IAEA,IACAC,YAAAlB,oBAAAmB,QACAC,wBAAA,KACAC;IACAA,cAAAF,SAAAD,YAAA;IACAG,cAAAC,QAAAJ,YAAAE,wBAAA;IACAC,cAAAE,QAAArB,oBAAAqB;IAEA7B,YAAAoB,IAAAjB,UAAAwB;;IAGAzB,SAAA4B,aAAA,eAAA;IACA5B,SAAA6B,cAAAC,aAAA7B,UAAAD;IAEA+B,oBAAA/B,UAAAC;IAEAD,SAAA6B,cAAAG,YAAAhC;IAEA,OAAAC;;EAGA,SAAA8B,oBAAA/B,UAAAC;IACAA,SAAAgC,KAAArC,SAAAsC;;;IAIArC,OAAAsC,aAAAvC,SAAAsC;;EAGA,SAAAE,KAAApC;;IAEAA,SAAA4B,aAAA,sBAAA;IAEA,OAAA7B,qBAAAC;;EAGA;IACAoC,MAAAA;;;;AC7GA1C,SAAAC,OAAA,sBAAA","file":"bp-img-placeholder.js.map","sourcesContent":["\"use strict\";\n","/*\n * Code to support the classic <img>-based placeholders. We ask customers to use <div display=\"inline-block\"> now.\n * TODO Once these go away we can remove this code.\n\n If the customer uses an <img> as a placeholder:\n We determine the color palette to be used based on the .src attribute.\n We create a <div> and insert it into the DOM as the previous sibling of the <img>\n We insert the <img> into the newly created <div>\n We remove the id from the <img>\n We set the id of the newly created <div> to BP_CONST.BADGE_ID\n\n Badge will never be statically positioned.  It must be relative or absolute\n so its contents can be absolutely positioned.\n\n */\n\nsitecues.define(\n  'bp-img-placeholder/bp-img-placeholder',[\n    'run/bp/constants',\n    'run/bp/helper',\n    'run/inline-style/inline-style'\n  ],\n  function (\n    BP_CONST,\n    helper,\n    inlineStyle\n  ) {\n  'use strict';\n  // Create <div> and put the existing badge inside it.\n  // Transfer necessary styles from the <img> to the <div>\n  function convertExistingBadge(badgeImg) {\n\n    var\n      newBadge            = document.createElement('sc'),\n      badgeImgBoundingBox = helper.getRect(badgeImg),\n      badgeComputedStyles = window.getComputedStyle(badgeImg),\n      stylesToTransfer    = [\n        'marginTop',\n        'marginBottom',\n        'marginLeft',\n        'marginRight',\n        'paddingTop',\n        'paddingBottom',\n        'paddingLeft',\n        'paddingRight'\n      ];\n\n    // Transfer styles from placeholder <img> to <div>\n    // Remove those styles from placeholder <img>\n    function transferStylesFromExistingBadge(styles) {\n      var\n        len = styles.length,\n        newBadgeStyles   = {},\n        badgeImageStyles = {};\n      for (var i = 0; i < len; i++) {\n        newBadgeStyles[styles[i]]   = helper.getNumberFromString(badgeComputedStyles[styles[i]]) + 'px';\n        badgeImageStyles[styles[i]] = 0;\n      }\n      inlineStyle.set(newBadge, newBadgeStyles);\n      inlineStyle.set(badgeImg, badgeImageStyles);\n    }\n\n    // Added to fix issue on ruhglobal.com\n    if (inlineStyle(badgeImg).position === 'relative') {\n      stylesToTransfer.push('top');\n      stylesToTransfer.push('left');\n    }\n\n    transferStylesFromExistingBadge(stylesToTransfer);\n\n    // Set other styles that cannot be abstracted into a helper function.\n    inlineStyle(newBadge).display = 'inline-block';\n\n    var\n      newHeight = badgeImgBoundingBox.height,\n      WIDTH_TO_HEIGHT_RATIO = 6.5,\n      newBadgeStyle = {};\n    newBadgeStyle.height = newHeight + 'px';\n    newBadgeStyle.width  = newHeight * WIDTH_TO_HEIGHT_RATIO + 'px';\n    newBadgeStyle.float  = badgeComputedStyles.float;\n\n    inlineStyle.set(newBadge, newBadgeStyle);\n\n    // Existing badge is hidden from screen readers, because the new <sc> parent will be the real badge\n    badgeImg.setAttribute('aria-hidden', true);\n    badgeImg.parentElement.insertBefore(newBadge, badgeImg);\n\n    moveBadgeIdToParent(badgeImg, newBadge);\n\n    badgeImg.parentElement.removeChild(badgeImg);\n\n    return newBadge;\n  }\n\n  function moveBadgeIdToParent(badgeImg, newBadge) {\n    newBadge.id = BP_CONST.BADGE_ID;\n\n    // Invalidate the id in the cache because we just removed the BADGE_ID\n    // from the <img> and set it on the <div>\n    helper.invalidateId(BP_CONST.BADGE_ID);\n  }\n\n  function init(badgeImg) {\n    // Will automatically use a different palette when dark theme is used\n    badgeImg.setAttribute('data-sc-reversible', false);\n\n    return convertExistingBadge(badgeImg);\n  }\n\n  return {\n    init: init\n  };\n});\n","\nsitecues.define(\"bp-img-placeholder\", function(){});\n"]}